# 測試設計技術詳細筆記

本文件整理自國立成功大學李信杰副教授的測試設計技術課程講義，主要介紹如何應對複雜邏輯與狀態依賴系統的測試設計方法。

## 第一部分：Decision Table (決策表)

面對包含大量「若...則...」（If... Then...）的複雜需求規則時，Decision Table 是規劃清晰且完整測試案例的最佳工具。

### 1. 核心步驟

建立 Decision Table 的標準化流程如下：

1.  **觀察需求**：確認需求描述中是否包含大量的邏輯判斷規則。
2.  **找出條件 (Condition)**：列出所有影響決策的輸入條件。例如：「客戶為 VIP」、「庫存充足」、「訂單金額 > $500」。
3.  **找出行動 (Action)**：列出滿足條件後系統應執行的動作。例如：「優先出貨」、「不優先出貨」。
4.  **繪製表格**：
    *   每一欄代表一個規則 (Rule)。
    *   填入條件值：`V` (True)、`X` (False) 或 `-` (Don't care)。
5.  **填寫規則**：根據需求邏輯填入對應的條件組合與結果。
    *   *注意*：避免出現 Overlapping Rule（重疊規則），確保邏輯清晰。
6.  **完整性檢查 (Completeness Check)**：
    *   理論上的組合總數為 $2^n$ (n 為布林條件的數量)。
    *   檢查目前的規則是否涵蓋了所有可能的組合。
    *   若有遺漏 (例如計算出的涵蓋組合數少於 8)，需補上遺漏的規則。

### 2. 重要概念：Don't Care

*   在表格中使用 `-` (Don't care) 表示該條件不影響結果。
*   **優勢**：使用 Don't Care 可以合併規則，大幅減少表格的複雜度，使測試規劃更易於 Review (審查)。
*   **對比**：若不使用 Decision Table 而直接請 AI 生成測試案例，可能會產生龐大且難以閱讀的列表，因為缺乏 Don't Care 的簡化邏輯。

### 3. AI 輔助應用

利用 AI (如 ChatGPT) 生成 Decision Table 可以節省腦力，但需提供精確的 Prompt (提示詞)：

*   **Prompt 技巧**：
    *   明確定義輸出格式：第一欄為規則編號，中間為 Condition，最後為 Action。
    *   指定標記方式：Boolean 值用 `V` / `X` / `-` 表示。
    *   邏輯要求：不得有重複情境，需注意 Don't care 造成的重複，並合併邏輯相同的規則,。
*   **驗證 AI 結果**：
    *   要求 AI 進行 Completeness Check，計算各規則涵蓋的情境數總和是否等於理論值 (如 $2^3=8$)。
    *   要求 AI 使用需求原文為底，將與特定規則邏輯相關的字詞**粗體標示**，以利人工 Review 彼此的關聯性。

### 4. 實務案例
*   **訂單優先出貨**：涉及 VIP 資格、庫存量、訂單金額門檻等多重條件,。
*   **線上服務免費試用**：涉及新戶資格、是否領取過、地區限制等負面表列條件。
*   **信用卡紅利積點 (複雜案例)**：涉及消費門檻 (滿3000)、單筆門檻 (滿30)、特殊卡別豁免、退貨扣回邏輯等，適合用 Decision Table 釐清,,。

---

## 第二部分：State Transition Testing (狀態轉換測試)

當系統輸出不僅取決於輸入，還取決於系統當下的「狀態」，或者「在不同時機點做同一動作會有不同效果」時，應使用此技術,。

### 1. 為什麼 Use Case Testing 不夠？

*   Use Case Testing 主要驗證使用者的操作流程 (如：投幣 -> 選擇商品 -> 出貨)。
*   但它可能遺漏了「時機點」的影響。例如：「在出貨過程中按退幣鈕」與「在投幣後按退幣鈕」，系統反應應該不同。
*   State Transition Testing 可補足 Use Case Testing 的盲點，網羅更完整的操作流程。

### 2. 核心步驟

1.  **找出動作/事件 (Event/Action)**：使用者執行的操作，如「投入硬幣」、「按下退幣」、「選擇商品」。
2.  **找出狀態 (State)**：系統存在的時機點。例如：「無投幣狀態」、「已投幣(未滿額)」、「已投幣(達標)」、「已出貨」,。
3.  **繪製狀態轉換圖 (State Transition Diagram)**：
    *   使用 `Event / Action [Guard]` 的格式來標示轉換路徑。
    *   Guard 代表轉換發生的守衛條件 (如：累積金額 < 10)。

### 3. 測試策略

*   **Transition Coverage (轉換覆蓋)**：測試案例需走過圖上的每一條轉換路徑。
*   **非法/未考慮的動作檢查 (Negative Testing)**：
    *   走到每個 State 時，嘗試執行「非法」或「未在圖上定義」的動作。
    *   例如：在金額不足的狀態下按下選擇商品，觀察系統是否顯示警告或忽略,。

### 4. AI 輔助應用

*   **生成圖表**：提供需求描述，要求 AI 以 **Mermaid** 語法繪製狀態轉移圖。
*   **圖表差異性**：AI 生成的狀態圖可能因抽象層次、命名偏好或對狀態定義不同而與預期有異，只要邏輯一致且支持測試目的即可接受,。
*   **關鍵字標示**：同樣可請 AI 將需求文字中與 State 和 Transition 相關的字詞標示出來，輔助審查。

### 5. 實務案例與工具
*   **飲料販賣機**：涉及投幣累計、金額判斷、退幣重置金額等狀態流轉,。
*   **福利卡儲值**：包含空卡、已儲值、已使用、申請退還中、已退還(作廢)等狀態循環。
*   **IDE 除錯工具 (IntelliJ)**：測試「執行」、「暫停」、「繼續」、「Step Over」等按鈕在不同 debug 狀態下的行為。

---

## 總結

| 技術名稱 | 適用情境 | 核心優勢 |
| :--- | :--- | :--- |
| **Decision Table** | 複雜的邏輯規則、多重條件判斷 (If... Then...) | 用最精簡的表格呈現完整的邏輯組合，利用 "Don't Care" 簡化測試案例。 |
| **State Transition** | 系統行為依賴於當下狀態、時序性操作 | 能夠發現 Use Case Testing 容易忽略的非法操作路徑與狀態依賴錯誤。 |

這兩種技術結合 AI 的生成與檢查功能，能顯著提升測試設計的效率與覆蓋率。